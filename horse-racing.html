<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <title>Horse racing</title>
    <style>
        body {
        	margin: 0 auto;
        	background: #232323;
        }
        .racer {
        	transition-duration: 500ms;
        	-moz-transition-duration: 500ms;
            -webkit-transition-duration: 500ms;
        	transition-property: transform;
        	-moz-transition-property: transform;
            -webkit-transition-property: transform;
        	transition-timing-function: linear;
        	-moz-transition-timing-function: linear;
            -webkit-transition-timing-function: linear;
        }
        .restart {
        	padding: 20px;
        	cursor: pointer;
        	font-family: 'Roboto', sans-serif;
        	font-weight: 700;
        	position: fixed;
        	bottom: 20px;
        	right: 20px;
        	border-radius: 100px;
        	height: 80px;
        	width: 80px;
        	transition: 200ms;
        	font-size: 2em;
        	border: none;
        	box-shadow: 0px 4px 4px #000;
        }
        .restart:hover {
        	height: 90px;
        	width: 90px;
        	bottom: 15px;
        	right: 15px;
        }
        .goldMedal, .silverMedal, .bronzeMedal {
        	transition: 500ms;
        }
    </style>
</head>
<body>
    <script>
        // add any number of riders you want!
        let ridersStore = [
        	{name: '1', color: 'brown', number: 1},
        	{name: '2', color: 'red', number: 2},
        	{name: '3', color: 'lime', number: 3},
        	{name: '4', color: 'purple', number: 4},
        	{name: '5', color: 'orange', number: 5},
        	{name: '6', color: 'yellow', number: 6},
        	{name: '7', color: 'gray', number: 7},
        	{name: '8', color: 'beige', number: 0},
        	{name: '9', color: 'goldenrod', number: 8},
        	{name: '10', color: 'lightblue', number: 9},
        	{name: '11', color: 'lightgreen', number: 10},
        	{name: '12', color: 'steelblue', number: 11},
        	{name: '13', color: 'coral', number: 12},
        	{name: '14', color: 'black', number: 13},
        	{name: '15', color: 'green', number: 14},
        	{name: '16', color: 'darkorchid', number: 15},
        	{name: '17', color: 'darksalmon', number: 16},
        	{name: '18', color: 'khaki', number: 17},
        	{name: '19', color: 'lavender', number: 18},
        	{name: '20', color: 'hotpink', number: 19},
        	{name: '21', color: 'lightskyblue', number: 20}
        ];
        let numRiders = 12;
        let winnerOffset = 1;
        let finishOrder = [];
        let maxRaceTime = 7000;
        let maxRaceDiff = 2000;
        let raceLength = 500;
        
        const randInt = (min, max) => {
        	return Math.floor(Math.random() * (max - min + 1)) + min;
        };
        
        function go() {
        	let riders = ridersStore.slice(0, numRiders);
        	let course = document.querySelector('#racecourse');
        	let startBuilding = document.querySelectorAll('.startBuilding > path');
        	let finishLinePaths = document.querySelectorAll('.finishLine > path');
        	let finishLine = raceLength - 100;
        	let buildingH = (riders.length * 20) + 4;
        	document.querySelector('.ground').setAttribute('width', raceLength);
        	document.querySelector('.goldMedal').setAttribute('transform', `scale(0.2 0.2) translate(${1170 + raceLength} -200)`);
        					document.querySelector('.silverMedal').setAttribute('transform', `scale(0.2 0.2) translate(${1170 + raceLength} -200)`);
        					document.querySelector('.bronzeMedal').setAttribute('transform', `scale(0.2 0.2) translate(${1170 + raceLength} -200)`);
        	
        	startBuilding[0].setAttribute('d', `M -10 -2 h 50 v ${buildingH} h-50`);
        	startBuilding[1].setAttribute('d', `M -10 -2 l 25 ${buildingH/8} v ${buildingH - (buildingH/3)} l-25 ${buildingH/5} M 40 -2 l-25 ${buildingH/8}v ${buildingH - (buildingH/3)} l25 ${buildingH/5}`);
        	course.setAttribute('viewBox', `-10 -10 ${raceLength} ${(riders.length * 20) + 20}`);
        	finishLinePaths[0].setAttribute('d', `M${finishLine} -10v${(riders.length * 20) + 20}`);
        	finishLinePaths[1].setAttribute('d', `M${finishLine} -2.5v${(riders.length * 20) + 5}`);
        	finishLinePaths[2].setAttribute('d', `M${finishLine} -2.5v${(riders.length * 20) + 5}`);
        	// reset stuff
        	winnerOffset = 0;
        	finishOrder = [];
        	let g = document.querySelector("#playerArea");
        	let gatesArea = document.querySelector("#gates");
        	const winnersSVG = document.querySelector("#winnersSVG");
        	// Remove existing racers
        	while (g.firstChild) {
        		g.removeChild(g.firstChild);
        	}
        	// Remove existing gates
        	while (gatesArea.firstChild) {
        		gatesArea.removeChild(gatesArea.firstChild);
        	}
        	let players = ``;
        	let gates = ``;
        	for (let i = 0; i < riders.length; i++) {
        		// create gates
        		gates += `<path d="M40 ${(i * 20)}v20" stroke="#fff" stroke-width="1">
        				<animateTransform class="blocks" attributeName="transform" attributeType="XML" type="rotate" values="0 40 ${(i * 20) + 20}; 90 40 ${(i * 20) + 20}" dur="200ms" begin="indefinite" fill="freeze" />
        			</path>`;
        		let steps = randInt(7, 14);
        		let keyTimes = `0`;
        		let splines = ``;
        		let vals = `10`;
        		
        		
        		for (let j = 1; j < steps; j++) {
        			keyTimes += `;${j / steps}`;
        			let lowerLimit = j / steps - (1 / steps) * 0.5;
        			let upperLimit = j / steps + (1 / steps) * 0.5;
        			vals += `;${randInt(Math.floor((finishLine - 30) * lowerLimit), Math.floor((finishLine - 30) * upperLimit))}`;
        			splines += `${randInt(10, 100) / 100} ${randInt(10, 100) / 100} ${randInt(10, 100) / 100} ${randInt(10, 100) / 100};`;
        		}
        		
        		
        		keyTimes += ";1";
        		splines += `0 0 0 0`;
        		vals += `;${finishLine - 30}`;
        		let dur = randInt(maxRaceTime - maxRaceDiff, maxRaceTime);
        		players += `<g class="racer">
        				<g stroke="#111" stroke-width="0.25" class="rider" data-player="${riders[i].name}" data-color="${riders[i].color}" data-lane="${i}">
        				<g>
        					<text class="racerName" stroke="none" fill="#fff" font-family="monospace" font-size="6" y="${7.5 + i * 20}" x="${-30 - (riders[i].name.length * 2)}">${riders[i].name}</text>
        					<animateTransform attributeName="transform" attributeType="XML" type="translate" values="0 0; -113 0" dur="${(180 / raceLength * dur)}ms" begin="raceMotion${i}.end" fill="freeze" />
        				</g>
        				<text class="racerFinish" fill="#ccc" stroke="#fff" font-family="monospace" font-size="7" y="${7.5 + i * 20}" x="-85" text-anchor="middle"></text>
        				<ellipse class="shadow" filter="url(#blur)" cx="8" cy="${22 + i * 20}" rx="17" ry="3" fill="rgba(0,0,0,0.5)" />
        				<g class="thingsThatGallop">
        					<use href="#horse" transform="translate(0 ${7.5 + i * 20})"  filter="brightness(${randInt(30, 70)}%)"/>
        					<path class="number" d="M 10 ${7.1 + i * 20} h ${4 + riders[i].number.toString().length} v 5 h -${4 + riders[i].number.toString().length}" fill="#fff" />
        					<text font-size="4" x="11.5" y="${11 + i * 20}">${riders[i].number || i}</text>
        					<animateTransform class="playerGallop" attributeName="transform" attributeType="XML" type="rotate" values="-12 10 ${7.5 + i * 20}; 12 10 ${7.5 + i * 20}; -12 10 ${7.5 + i * 20}" dur="500ms" begin="${randInt(-3000, 0)}ms" repeatCount="indefinite" />
        				</g>
        				<use href="#jockey" fill="${riders[i].color}" transform="translate(0 ${7.1 + i * 20})" />
        				<animateTransform attributeName="transform" attributeType="XML" type="translate" values="0 0; 130 0" dur="${(180 / raceLength * dur)}ms" begin="raceMotion${i}.end" fill="freeze" keyTimes="0;1" keySplines="0.67 0.64 0.37 0.28" calcMode="spline" />
        			</g>
        		<animateTransform id="raceMotion${i}" class="players" attributeName="transform" attributeType="XML" type="translate" values="${vals}" dur="${dur}ms" begin="indefinite" keyTimes="${keyTimes}" keySplines="${splines}" calcMode="spline" fill="freeze" />
        		</g>`;
        	}
        	const wrapper = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        	wrapper.innerHTML = `<g>${players}</g>`;
        	const doc = wrapper.firstChild;
        	g.appendChild(doc);
        	const wrapper2 = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        	wrapper2.innerHTML = `<g>${gates}</g>`;
        	const doc2 = wrapper2.firstChild;
        	gatesArea.appendChild(doc2);
        
        	
        	// open the gates
        	document.querySelectorAll(".blocks").forEach((gate) => {
        		gate.beginElement();
        	});
        	
        	// start the race
        	document.querySelectorAll(".players").forEach((player) => {
        		player.beginElement();
        		if (!player._hasListener) {
        			player._hasListener = true;
        			// Add the animationend event listener
        			player.addEventListener("endEvent", (event) => {
        				let rider = player.parentElement.querySelector(".rider");
        				finishOrder.push([rider.getAttribute("data-player"), rider.getAttribute("data-color"), rider.getAttribute("data-lane")]);
        				if (finishOrder.length === 1) {
        					document.querySelector('.medals').setAttribute('transform', `translate(${raceLength - 95} 0)`);
        					document.querySelector('.goldMedal').setAttribute('transform', `scale(0.2 0.2) translate(0 ${100 * finishOrder[0][2] - 24})`);
        				}
        				if (finishOrder.length === 2) {
        					document.querySelector('.silverMedal').setAttribute('transform', `scale(0.2 0.2) translate(0 ${100 * finishOrder[1][2] - 24})`);
        				}
        				if (finishOrder.length === 3) {
        					document.querySelector('.bronzeMedal').setAttribute('transform', `scale(0.2 0.2) translate(0 ${100 * finishOrder[2][2] - 24})`);
        				}
        				if (finishOrder.length === riders.length) {
        					for (let o=3; o<finishOrder.length; o++) {
        						document.querySelector(`[data-player="${finishOrder[o][0]}"] > .racerFinish`).textContent = o + 1;
        					}
        					// console.log('Race over!');
        				}
        			});
        		}
        	});
        }
        go();
        document.querySelector(".restart").addEventListener("click", go);
        
        
        
        // knob settings
        let settings = {
        	visible: 0,
        	knobs: [
        		{
              label: 'Racers',
        			labelTitle: 'Changes the number of racers in the race',
              type: "range",
        			value: 12,
        			min: 2,
        			max: ridersStore.length,
              onChange: (e) => {
        				numRiders = e.target.value * 1;
              }
            },
            {
              label: 'Racer Type',
        			labelTitle: 'Which animal is racing',
              render: `
                <button type='button' class='horses'>Horses</button>
                <button type='button' class='crabs'>Crabs</button>
                <button type='button' class='ducks'>Ducks</button>
                <button type='button' class='snails'>Snails</button>
              `,
              script(knobs, name){
                knobs.getKnobElm(name).addEventListener("click", e => {
                  if( e.target.tagName == 'BUTTON' ) {
        					const racer = document.querySelector('#horse');
        					switch(e.target.textContent) {
        							case 'Horses':
        								racer.setAttribute('d', 'M 10 0 c 1.7 0.1 4.6 -1 5.5 -1.6 c -0.7 -0.2 -1.1 -0.2 -1 -0.3 c 1.2 -0.1 1.4 -0.1 1.5 -0.1 c 0 0 0.2 0 0.2 -0.1 c 0 0 -0.2 0 -0.2 0 c -0.2 -0.1 -0.5 -0.2 -0.6 -0.2 c 0 0 -0.2 0 -0.2 0 c 0 -0.1 0.2 -0.1 0.2 -0.1 c 0.3 0 0.5 -0.1 0.8 -0.1 c 0.1 0 0.4 0 0.4 0 c 0 -0.1 -0.3 -0.1 -0.5 -0.2 c -0.1 -0.1 0.6 -0.2 0.8 -0.1 c 0 0 0.3 0.1 0.3 0 c 0 -0.1 -0.7 -0.3 -0.7 -0.4 c 0.2 -0.1 0.5 0 0.9 0.1 c 0.2 0 0.7 0.2 0.7 0.1 c 0.1 -0.2 -0.5 -0.3 -0.4 -0.4 c 0 -0.2 0.5 -0.1 0.8 0 c 0.4 0.1 0.6 0 0.5 -0.1 c -0.5 -0.3 0 -0.2 0.1 -0.2 c 0.3 0 0.6 0.1 0.8 0.2 c 0.2 0.1 -0.1 -0.3 0 -0.4 c 0 -0.1 0.5 0.1 0.7 0.2 c 0.1 0 0.2 0 0.3 -0.1 c 0.1 -0.1 0.2 -0.3 0.2 -0.4 c 0 -0.1 0.2 -0.2 0.3 -0.4 c 0.1 -0.1 0.1 -0.4 0.2 -0.4 c 0.1 0 0.4 0.4 0.4 0.5 c 0.1 0.2 0.2 0.5 0.3 0.7 c 0.1 0.1 0 0.4 0 0.5 c 0 0 0 0 0 0 c 0.2 0.2 0.3 0.5 0.5 0.6 c 0.3 0.4 1.1 1.8 1.3 2.1 c 0.2 0.3 0.8 1 0.8 1.1 c 0 0.2 0.1 0.4 0.2 0.5 c 0.2 0.2 0.1 0.5 0 0.7 c -0.1 0.2 -0.4 0.3 -0.5 0.3 c -0.1 0.1 -0.4 0.2 -0.5 0.1 c -0.2 0 -0.2 -0.2 -0.5 -0.5 c -0.4 -0.3 -0.7 -0.8 -1 -1.1 c -0.4 -0.1 -0.8 -0.3 -1.1 -0.3 c -0.2 -0.1 -0.6 -0.2 -0.8 -0.4 c -0.3 0.4 -2.5 2.3 -2.8 2.5 c -0.1 1.1 -0.1 2.1 -0.2 2.4 c -0.2 0.3 -0.3 0.6 -0.1 0.9 c 0.6 1.1 1.5 2.6 1.6 2.8 c 0.2 0.3 0.3 0.2 0.5 0.5 c 0.1 0.3 0.8 1.7 1.4 2.2 c 0.5 0.4 1.1 1.2 1.4 1.4 c 0.2 0.3 0.7 0.5 0.9 0.7 c 0.1 0.3 0.5 0.8 0.5 0.9 c -0.1 0.1 -1.4 0 -1.4 -0.2 c -0.1 -0.3 -0.2 -0.5 -0.1 -0.7 c -0.2 -0.1 -0.5 -0.5 -0.9 -0.5 c -0.3 -0.1 -1.5 -2.1 -1.7 -2.4 c -0.3 -0.3 -0.4 -0.1 -0.7 -0.5 c -0.4 -0.4 -0.5 -0.8 -1 -1.1 c -0.4 -0.2 -1.3 -1.5 -1.9 -2.2 c -0.5 0.1 -0.8 0.2 -1.3 0.2 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c -0.1 0 -0.1 0 -0.1 0 c -0.6 0.1 -1.5 0.8 -1.8 1.2 c -0.4 0.4 -1 0.8 -1.4 1.4 c -0.3 0.4 -0.7 1.1 -1.2 1.7 c -0.3 0.4 -0.6 0.7 -0.6 0.8 c 0.1 0.3 -0.5 0.9 -0.6 1 c -0.1 0.2 0 0.4 0.1 0.6 c 0.2 0.3 0 1 -0.1 1.1 c -0.1 0.2 -1.3 -0.7 -1.1 -1 c 0.1 -0.2 0.5 -0.5 0.5 -0.6 c 0 -0.2 0.2 -0.6 0.3 -0.9 c 0.2 -0.2 1.1 -1.3 1.2 -1.5 c 0.1 -0.3 0.5 -1.4 0.6 -1.6 c 0.1 -0.4 0.6 -0.8 0.9 -1.3 c 0.1 -0.1 0.2 -0.3 0.3 -0.5 c -1.1 -0.2 -2.3 -0.6 -3.1 -0.9 c -1 -0.3 -3.4 -1.4 -4 -1.4 c -0.9 0.1 -1.4 0.4 -2.2 0.6 c -1 0.4 -1.6 1.2 -1.9 1.3 c -0.5 0.1 -1.2 1.5 -1.4 1.8 c -0.4 0.3 -1.4 1.2 -1.5 1.4 c -0.1 0.2 -0.2 0.3 -0.4 0.4 c -0.4 0.2 -1.3 1.3 -1.4 1.7 c -0.1 0.5 -0.3 0.7 -0.5 0.8 c -0.3 0.2 -0.5 0.1 -0.7 0.5 c -0.1 0.3 -0.5 1.2 -1.1 1.4 c -0.5 0.1 -0.4 -0.3 -0.4 -0.6 c 0 -0.4 0.2 -1 0.5 -1 c 0.3 -0.1 0.5 0 0.6 -0.2 c 0.2 -0.2 0.1 -0.4 0.3 -0.6 c 0.2 -0.2 0.8 -0.5 0.9 -0.9 c 0.2 -0.4 0.8 -1.4 0.8 -1.8 c 0.1 -0.4 0.9 -1.2 1.2 -1.6 c -0.7 0.5 -2.4 1.5 -2.7 1.7 c -0.3 0.3 -0.7 1.1 -0.9 1.2 c -0.3 0.2 -0.7 0.4 -1 0.5 c -0.3 0.1 -0.6 0.2 -1 0.4 c -0.5 0.1 -0.7 0.1 -0.8 0.1 c -0.2 -0.1 -0.1 -1.1 0.5 -1.4 c 0.5 0 0.7 0.2 1 0.1 c 0.3 -0.1 0.2 -0.4 0.4 -0.5 c 0.2 -0.1 0.8 -0.2 0.9 -0.4 c 0.2 -0.2 1.4 -1.4 1.6 -1.7 c 0.3 -0.4 0.7 -1.2 0.9 -1.4 c 0.3 -0.2 0.9 -0.3 1.3 -0.5 c 0.4 -0.2 0.9 -0.6 1.2 -1.1 c -0.2 -0.9 0 -2.2 -0.1 -2.8 c 0 -0.5 0.2 -1 0.4 -1.4 c 0 -0.1 0 -0.1 -0.1 -0.1 c -0.4 -0.1 -0.9 0.4 -1.2 0.5 c -1.1 0.3 -0.9 0.2 -0.6 0 c -1.3 0.2 -1.8 0.6 -1.8 0.6 c 0.1 -0.1 0.2 -0.2 0.3 -0.3 c -0.2 0 -0.6 0.4 -0.9 0.5 c -0.6 0.1 -0.8 0.1 -0.9 0.2 c -0.1 0 -0.2 0 -0.2 0 c 0 0 0.2 -0.1 0.2 -0.1 c 0.1 0 0.3 -0.1 0.4 -0.2 c 0.1 -0.1 0.1 -0.1 0.1 -0.1 c -0.1 -0.1 -0.3 0 -0.4 0 c -0.2 0 -0.4 0.2 -0.5 0.2 c -1.1 0.2 -1.6 0.3 -1.6 0.3 c 0.6 -0.3 1 -0.3 1.1 -0.4 c -2 0.1 -2.2 0.2 -2.5 0.3 c 0 -0.1 0.6 -0.4 1.3 -0.5 c -0.2 -0.1 -1.6 -0.1 -1.8 0 c 0.1 -0.1 0.1 -0.1 0.4 -0.2 c 1.6 -0.3 1.8 -0.4 1.9 -0.4 c 0 0 -0.1 0 -0.1 0 l -0.5 0 c -0.4 0 -0.7 -0.2 -1.1 -0.2 c -0.8 0 0.2 -0.1 0.2 -0.1 c 0.1 0 0.1 0 0.3 -0.1 c -0.2 -0.1 -0.7 -0.1 -0.9 0 c -0.2 0.1 -0.3 0.2 -0.4 0.2 c 0.2 -0.3 0.5 -0.4 0.7 -0.4 c 0.5 0 1.3 -0.1 1.7 -0.1 c 0.6 0.1 0.7 0 0.7 0 c 0 0 0.4 -0.1 0.5 -0.1 c 0.5 0 1.2 0.3 1.7 0.2 c 0.3 0 0.5 0 0.7 -0.1 c -0.2 -0.1 -0.3 -0.1 -0.3 -0.2 c 0.1 0 0.5 0.1 0.6 0.1 c 0.8 0 1.1 0 1.4 -0.1 c 2.1 -0.2 2.2 -0.2 2.3 -0.3 c 0.5 -0.3 2.6 -0.7 3.6 -0.8 c 1.1 0 2.7 0.5 3.2 0.5 c 0.5 0 1.9 0.6 3.1 0.4 z');
        						racer.setAttribute('fill', 'tan');
        							break;
        						case 'Crabs':
        							racer.setAttribute('d', 'M 13.6 -1.2 l -0.3 0 a 3.4 3.4 90 0 0 -2 0 l -0.3 0 a 5.4 5.4 90 0 1 0 -0.8 a 0.8 0.8 90 1 0 -0.6 -0.2 a 3.5 3.5 90 0 0 -0.1 1 q -0.6 0 -1.2 0.2 l -2 -1.4 c 0.4 -0.5 0.4 -1.3 0.2 -2.2 c 1.5 -0.6 3.1 -2.5 2.4 -4.4 a 5.6 5.6 90 0 1 -2.6 2.8 c -0.1 -1 0.3 -2.3 1 -3.8 a 6.1 6.1 90 0 0 -3 3.3 c -0.4 1.2 -0.6 3.8 0.7 4.5 a 7.1 7.1 90 0 0 1.3 2 a 3.8 3.8 90 0 0 -1.6 2.3 a 2.7 2.7 90 0 1 -0.9 -1.4 l -0.3 0 a 3.1 3.1 90 0 0 -0.6 -2.6 l -0.2 0.1 a 7.2 7.2 90 0 1 -0.5 -3.3 q 0 -0.3 -0.2 -0.1 a 3.7 3.7 90 0 0 -0.3 3.7 l -0.2 0.1 a 5.9 5.9 90 0 1 1 2.8 l -0.2 0.3 a 4.5 4.5 90 0 0 2.4 1.6 a 3.5 3.5 90 0 0 0.2 0.7 q -1.7 -1 -1.7 -0.3 a 2.1 2.1 90 0 1 -1.5 -1.5 l -0.5 0 a 3.9 3.9 90 0 1 -1.7 -2.6 q -0.1 -0.4 -0.2 -0.1 a 3.8 3.8 90 0 0 1.2 3.8 l -0.2 0.2 a 4.6 4.6 90 0 0 2.8 1.1 l 0.1 0.5 a 4.7 4.7 90 0 0 2.1 -0.3 a 5.2 5.2 90 0 0 0.4 0.5 a 5.2 5.2 90 0 1 -2.3 0.5 v 0.4 a 1.9 1.9 90 0 0 -1.3 1.7 c -0.3 0.3 -0.5 0.9 -0.5 1.5 a 3.1 3.1 90 0 0 0.6 1.7 q 0.2 0.2 0.2 0 a 3.6 3.6 90 0 1 0.2 -2.7 l 0.4 -0.1 a 2.4 2.4 90 0 1 0.8 -1.4 a 2.6 2.6 90 0 0 2.4 -1 c 3.2 2.4 7.2 2.2 10.5 0 q 0.9 1.4 2.5 1 a 2.1 2.1 90 0 1 0.9 1.5 l 0.3 0 a 12.5 12.5 90 0 1 0.2 2.7 a 0.1 0.1 90 0 0 0 0 q 0 0.3 0.2 0 c 0.9 -2.1 0.4 -2.9 0.1 -3.2 a 1.6 1.6 90 0 0 -1.3 -1.8 v -0.3 a 2.8 2.8 90 0 1 -2.4 -0.5 a 4.3 4.3 90 0 0 0.4 -0.5 a 5.8 5.8 90 0 0 2.2 0.2 l 0 -0.4 a 3.6 3.6 90 0 0 2.7 -1.3 l -0.2 -0.1 a 3.6 3.6 90 0 0 1.4 -3.7 q -0.1 -0.3 -0.2 0 a 5.7 5.7 90 0 1 -1.8 2.7 l -0.3 0 a 2.5 2.5 90 0 1 -1.6 1.5 l 0 -0.4 q -1.1 0.9 -1.8 0.7 a 7 7 90 0 0 0.2 -0.7 a 4.8 4.8 90 0 0 2.4 -1.5 a 3.9 3.9 90 0 1 0.9 -3.1 l -0.3 -0.2 a 3.1 3.1 90 0 0 -0.3 -3.6 q -0.1 -0.1 -0.1 0 a 7.2 7.2 90 0 1 -0.5 3.2 l -0.2 -0.1 a 3.2 3.2 90 0 0 -0.6 2.7 a 2.7 2.7 90 0 1 -0.3 -0.1 a 2.2 2.2 90 0 1 -0.9 1.6 a 3.1 3.1 90 0 0 -1.5 -2.4 a 7.4 7.4 90 0 0 1.2 -1.9 c 1.3 -0.7 1.1 -3.4 0.7 -4.5 a 6.1 6.1 90 0 0 -3.1 -3.4 c 0.8 1.5 1.1 2.8 1.1 3.8 a 5.6 5.6 90 0 1 -2.6 -2.8 c -0.7 1.9 0.8 3.8 2.4 4.4 c -0.2 0.9 -0.2 1.7 0.2 2.2 l -2.1 1.4 q -0.6 -0.1 -1.1 -0.1 a 3.5 3.5 90 0 0 -0.1 -1.1 a 0.8 0.8 90 1 0 -0.6 0.2 a 5.3 5.3 90 0 1 0 0.8 z');
        							racer.setAttribute('fill', '#f00');
        							break;
        						case 'Ducks':
        							racer.setAttribute('d', 'M 17.2 -11.6 c -0.5 0.1 -0.8 0.2 -1.2 0.6 c -1.4 1.4 -1.4 3.6 -1.2 5.4 c 0.4 2.2 0.4 2.8 -0.1 3.5 c -2.5 -0.5 -3.5 -0.4 -4.7 0.1 c -6 3 -6 3 -6 3 c -0.2 0 -0.2 0 -0.4 -0.2 c -0.6 -0.2 -1 -0.2 -1 -0.2 c -0.2 0 -0.4 0 -0.4 0.4 c 0 0 0 0.2 0 0.2 c -0.4 -0.4 -0.8 -0.4 -1.1 -0.3 c -0.2 0.1 0 0.5 0.1 0.9 c -0.3 0 -0.5 0.1 -0.2 0.4 c 0.2 0.4 -0.1 0.8 -0.4 0.6 c -0.3 -0.2 -0.4 -0.2 -0.4 -0.1 c 0 0.3 0 0.3 0.2 0.5 c 0.2 0.2 0.4 0.2 0.4 0.2 c -0.5 0.3 -0.6 0.4 -0.2 0.6 c 0.7 0.3 2.2 1.3 3 1.4 c 0.1 1.2 4.4 3.2 5.7 3.4 c 0.1 0.8 0.3 1.2 0.3 1.6 c 0 1.6 -0.2 0.8 0 1.8 c 0 0.4 0.3 1.3 1 1.3 c 4 0.1 4 0.1 4 -0.1 c 0 0 -0.2 0 -0.4 -0.2 c 0.2 -0.3 -0.3 -1.1 -0.9 -1.2 c -1.9 0 -1.9 -0.2 -2.1 -0.2 c -0.2 -0.2 -0.2 -0.2 -0.2 -0.2 c 0 -0.2 0 -0.4 -0.2 -0.6 c 0 0 0 0 0 -0.2 c 0 0 0 -0.2 -0.2 -0.4 c -0.2 -0.4 0 -0.4 -0.2 -0.8 c 0 -0.8 0 -0.8 0 -0.8 c 0.4 0.2 0.8 0.2 3 0.3 c -0.7 1.8 -0.4 2.1 -0.4 2.1 c 0.1 0.1 0.3 -0.4 0.4 -0.3 c 0 0.5 0 0.5 0 0.5 c 0 0.4 0.8 1 1 1 c 0.6 0 0.8 0.2 0.8 -0.2 c 2.4 -0.2 2.3 0 2.4 -0.2 c 0.1 -0.2 0 -0.3 -0.5 -0.4 c 0.4 -0.4 0.4 -0.9 0.7 -0.8 c 0.1 0 0.2 -0.1 0 -0.2 c -0.8 -0.4 -1 -0.4 -1.6 -0.2 c -0.4 0.2 -0.6 0.2 -0.8 0.2 c -0.6 0 -0.6 0 -0.6 0 c 0 -0.2 0 -0.2 -0.2 -0.2 c -0.1 -0.9 -0.3 -0.9 -0.2 -1.4 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 11.8 -0.4 7 -9.2 6 -10.4 c -0.8 -1.4 -1.6 -3 -1.8 -3.8 c -0.2 -0.4 -0.2 -1 -0.2 -1.2 c 0 0 0 0 0.2 0 c 0 0 0 0 0.2 0.2 c 0.2 0.2 0.4 0.4 0.8 0.6 c 0.4 0.4 0.8 0.4 1.2 0.4 c 0.4 0.2 0.8 0.2 1 0.4 c 0.6 0 0.8 0 0.8 -0.2 c 0.2 -0.2 0.2 -0.4 0.2 -0.6 c 0 -0.4 -0.2 -0.6 -0.6 -0.8 c -0.4 0 -0.8 -0.4 -1.2 -0.8 c -0.4 -0.4 -0.6 -0.6 -0.6 -0.8 c -0.2 0 -0.2 -0.6 -0.2 -0.6 c 0 0 0 -0.2 -0.2 -0.2 c 0 0 0 0 0 -0.2 c 0.2 -1.6 -0.7 -2.9 -2.8 -2.6 z');
        							racer.setAttribute('fill', '#ff0');
        							break;
        						case 'Snails':
        							racer.setAttribute('d', 'M 24.1 -0.4 c -0.7 0 -1.1 0.5 -1.1 1.1 c 0 0.3 0 0.5 0.2 0.7 l -1.6 2.7 c -0.2 0 -0.4 0 -0.6 0 v -2.4 c 0.4 -0.1 0.6 -0.5 0.6 -1 c 0 -0.6 -0.4 -1.1 -1 -1.1 c -0.7 0 -1.2 0.5 -1.2 1.1 c 0 0.5 0.3 0.9 0.7 1 v 2.6 c -1 0.4 -2.5 1.1 -4.7 2.6 c 0.3 -0.5 1.1 -2.1 -1.4 -2.5 c -0.6 -3.6 -3.7 -6.3 -7.4 -6.3 c -4.1 0 -7.5 3.4 -7.5 7.5 c 0 0.2 0 0.5 0.1 0.7 l 0 0 c 0 0 -3.4 1.5 -0.7 3 c -1.2 0.6 -3.5 2.2 -3.5 2.2 s -2.6 1.6 0.6 1.6 h 19.9 c 0 0 2 0 3.9 -2.8 c 2 -2.9 4.8 -3.2 4.8 -4.5 c 0 -0.9 -0.8 -1.4 -1.7 -1.6 l 1.4 -2.4 c 0.1 0 0.1 0 0.2 0 c 0.6 0 1.1 -0.5 1.1 -1.1 c 0 -0.6 -0.5 -1.1 -1.1 -1.1 z');
        							racer.setAttribute('fill', '#0ff');
        							break;
        					}
        				}
                });
              },
            },
        		{
        			label: "Race Length",
        			labelTitle: 'How far do the racers go',
        			type: "range",
        			value: 500,
        			min: 300,
        			max: 1500,
        			onChange: (e) => {
        				raceLength = e.target.value * 1;
        			}
        		},
        		{
        			label: "Max Time Apart (ms)",
        			labelTitle: 'Maximum possible distance between first and last place.',
        			type: "range",
        			value: 1500,
        			min: 200,
        			max: 3000,
        			onChange: (e) => {
        				maxRaceDiff = e.target.value * 1;
        			}
        		},
        		{
        			label: "Max Race Time (ms)",
        			labelTitle: 'Slowest racer will only be able to go this slow.',
        			type: "range",
        			value: 7000,
        			min: 3000,
        			max: 20000,
        			onChange: (e) => {
        				maxRaceTime = e.target.value * 1;
        			}
        		},
        		{
              label: 'Ground Texture',
        			labelTitle: 'Use the mud texture on the ground.',
              type: 'checkbox',
              value: true,
              onChange: (e) => {
        				e.target.checked ? document.querySelector('.ground').setAttribute('filter', 'url(#mud)') : document.querySelector('.ground').setAttribute('filter', '');
        			}
            }
        	]
        };
        
        const myKnobs = new Knobs(settings);
    </script>
    <svg id="racecourse" viewBox="-10 -10 500 140">
        <defs>
            <filter id="mud">
                <feTurbulence baseFrequency="0.85" numOctaves="10" seed="113" />
                <feColorMatrix values="2.4 -0.6 -2.8 -1.7 -0.3 -3.1 -1.8 -1.8 -4.1 2.7 0.8 -3.1 2.9 -0.8 3.7 -2.2 4.2 -0.5 3.1 -1.3" />
                <feDiffuseLighting lighting-color="rgb(102,74,52)" surfaceScale="1">
                    <feDistantLight azimuth="270" elevation="90" />
                </feDiffuseLighting>
            </filter>
            <filter id="blur" x="-100%" y="-100%" width="300%" height="300%">
                <feGaussianBlur in="SourceGraphic" stdDeviation="2" />
            </filter>
            <radialGradient id="grad">
                 <stop offset="50%" stop-color="forestgreen" />
                 <stop offset="100%" stop-color="green" />
            </radialGradient>
            <path id="horse" d="M 10 0 c 1.7 0.1 4.6 -1 5.5 -1.6 c -0.7 -0.2 -1.1 -0.2 -1 -0.3 c 1.2 -0.1 1.4 -0.1 1.5 -0.1 c 0 0 0.2 0 0.2 -0.1 c 0 0 -0.2 0 -0.2 0 c -0.2 -0.1 -0.5 -0.2 -0.6 -0.2 c 0 0 -0.2 0 -0.2 0 c 0 -0.1 0.2 -0.1 0.2 -0.1 c 0.3 0 0.5 -0.1 0.8 -0.1 c 0.1 0 0.4 0 0.4 0 c 0 -0.1 -0.3 -0.1 -0.5 -0.2 c -0.1 -0.1 0.6 -0.2 0.8 -0.1 c 0 0 0.3 0.1 0.3 0 c 0 -0.1 -0.7 -0.3 -0.7 -0.4 c 0.2 -0.1 0.5 0 0.9 0.1 c 0.2 0 0.7 0.2 0.7 0.1 c 0.1 -0.2 -0.5 -0.3 -0.4 -0.4 c 0 -0.2 0.5 -0.1 0.8 0 c 0.4 0.1 0.6 0 0.5 -0.1 c -0.5 -0.3 0 -0.2 0.1 -0.2 c 0.3 0 0.6 0.1 0.8 0.2 c 0.2 0.1 -0.1 -0.3 0 -0.4 c 0 -0.1 0.5 0.1 0.7 0.2 c 0.1 0 0.2 0 0.3 -0.1 c 0.1 -0.1 0.2 -0.3 0.2 -0.4 c 0 -0.1 0.2 -0.2 0.3 -0.4 c 0.1 -0.1 0.1 -0.4 0.2 -0.4 c 0.1 0 0.4 0.4 0.4 0.5 c 0.1 0.2 0.2 0.5 0.3 0.7 c 0.1 0.1 0 0.4 0 0.5 c 0 0 0 0 0 0 c 0.2 0.2 0.3 0.5 0.5 0.6 c 0.3 0.4 1.1 1.8 1.3 2.1 c 0.2 0.3 0.8 1 0.8 1.1 c 0 0.2 0.1 0.4 0.2 0.5 c 0.2 0.2 0.1 0.5 0 0.7 c -0.1 0.2 -0.4 0.3 -0.5 0.3 c -0.1 0.1 -0.4 0.2 -0.5 0.1 c -0.2 0 -0.2 -0.2 -0.5 -0.5 c -0.4 -0.3 -0.7 -0.8 -1 -1.1 c -0.4 -0.1 -0.8 -0.3 -1.1 -0.3 c -0.2 -0.1 -0.6 -0.2 -0.8 -0.4 c -0.3 0.4 -2.5 2.3 -2.8 2.5 c -0.1 1.1 -0.1 2.1 -0.2 2.4 c -0.2 0.3 -0.3 0.6 -0.1 0.9 c 0.6 1.1 1.5 2.6 1.6 2.8 c 0.2 0.3 0.3 0.2 0.5 0.5 c 0.1 0.3 0.8 1.7 1.4 2.2 c 0.5 0.4 1.1 1.2 1.4 1.4 c 0.2 0.3 0.7 0.5 0.9 0.7 c 0.1 0.3 0.5 0.8 0.5 0.9 c -0.1 0.1 -1.4 0 -1.4 -0.2 c -0.1 -0.3 -0.2 -0.5 -0.1 -0.7 c -0.2 -0.1 -0.5 -0.5 -0.9 -0.5 c -0.3 -0.1 -1.5 -2.1 -1.7 -2.4 c -0.3 -0.3 -0.4 -0.1 -0.7 -0.5 c -0.4 -0.4 -0.5 -0.8 -1 -1.1 c -0.4 -0.2 -1.3 -1.5 -1.9 -2.2 c -0.5 0.1 -0.8 0.2 -1.3 0.2 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c -0.1 0 -0.1 0 -0.1 0 c -0.6 0.1 -1.5 0.8 -1.8 1.2 c -0.4 0.4 -1 0.8 -1.4 1.4 c -0.3 0.4 -0.7 1.1 -1.2 1.7 c -0.3 0.4 -0.6 0.7 -0.6 0.8 c 0.1 0.3 -0.5 0.9 -0.6 1 c -0.1 0.2 0 0.4 0.1 0.6 c 0.2 0.3 0 1 -0.1 1.1 c -0.1 0.2 -1.3 -0.7 -1.1 -1 c 0.1 -0.2 0.5 -0.5 0.5 -0.6 c 0 -0.2 0.2 -0.6 0.3 -0.9 c 0.2 -0.2 1.1 -1.3 1.2 -1.5 c 0.1 -0.3 0.5 -1.4 0.6 -1.6 c 0.1 -0.4 0.6 -0.8 0.9 -1.3 c 0.1 -0.1 0.2 -0.3 0.3 -0.5 c -1.1 -0.2 -2.3 -0.6 -3.1 -0.9 c -1 -0.3 -3.4 -1.4 -4 -1.4 c -0.9 0.1 -1.4 0.4 -2.2 0.6 c -1 0.4 -1.6 1.2 -1.9 1.3 c -0.5 0.1 -1.2 1.5 -1.4 1.8 c -0.4 0.3 -1.4 1.2 -1.5 1.4 c -0.1 0.2 -0.2 0.3 -0.4 0.4 c -0.4 0.2 -1.3 1.3 -1.4 1.7 c -0.1 0.5 -0.3 0.7 -0.5 0.8 c -0.3 0.2 -0.5 0.1 -0.7 0.5 c -0.1 0.3 -0.5 1.2 -1.1 1.4 c -0.5 0.1 -0.4 -0.3 -0.4 -0.6 c 0 -0.4 0.2 -1 0.5 -1 c 0.3 -0.1 0.5 0 0.6 -0.2 c 0.2 -0.2 0.1 -0.4 0.3 -0.6 c 0.2 -0.2 0.8 -0.5 0.9 -0.9 c 0.2 -0.4 0.8 -1.4 0.8 -1.8 c 0.1 -0.4 0.9 -1.2 1.2 -1.6 c -0.7 0.5 -2.4 1.5 -2.7 1.7 c -0.3 0.3 -0.7 1.1 -0.9 1.2 c -0.3 0.2 -0.7 0.4 -1 0.5 c -0.3 0.1 -0.6 0.2 -1 0.4 c -0.5 0.1 -0.7 0.1 -0.8 0.1 c -0.2 -0.1 -0.1 -1.1 0.5 -1.4 c 0.5 0 0.7 0.2 1 0.1 c 0.3 -0.1 0.2 -0.4 0.4 -0.5 c 0.2 -0.1 0.8 -0.2 0.9 -0.4 c 0.2 -0.2 1.4 -1.4 1.6 -1.7 c 0.3 -0.4 0.7 -1.2 0.9 -1.4 c 0.3 -0.2 0.9 -0.3 1.3 -0.5 c 0.4 -0.2 0.9 -0.6 1.2 -1.1 c -0.2 -0.9 0 -2.2 -0.1 -2.8 c 0 -0.5 0.2 -1 0.4 -1.4 c 0 -0.1 0 -0.1 -0.1 -0.1 c -0.4 -0.1 -0.9 0.4 -1.2 0.5 c -1.1 0.3 -0.9 0.2 -0.6 0 c -1.3 0.2 -1.8 0.6 -1.8 0.6 c 0.1 -0.1 0.2 -0.2 0.3 -0.3 c -0.2 0 -0.6 0.4 -0.9 0.5 c -0.6 0.1 -0.8 0.1 -0.9 0.2 c -0.1 0 -0.2 0 -0.2 0 c 0 0 0.2 -0.1 0.2 -0.1 c 0.1 0 0.3 -0.1 0.4 -0.2 c 0.1 -0.1 0.1 -0.1 0.1 -0.1 c -0.1 -0.1 -0.3 0 -0.4 0 c -0.2 0 -0.4 0.2 -0.5 0.2 c -1.1 0.2 -1.6 0.3 -1.6 0.3 c 0.6 -0.3 1 -0.3 1.1 -0.4 c -2 0.1 -2.2 0.2 -2.5 0.3 c 0 -0.1 0.6 -0.4 1.3 -0.5 c -0.2 -0.1 -1.6 -0.1 -1.8 0 c 0.1 -0.1 0.1 -0.1 0.4 -0.2 c 1.6 -0.3 1.8 -0.4 1.9 -0.4 c 0 0 -0.1 0 -0.1 0 l -0.5 0 c -0.4 0 -0.7 -0.2 -1.1 -0.2 c -0.8 0 0.2 -0.1 0.2 -0.1 c 0.1 0 0.1 0 0.3 -0.1 c -0.2 -0.1 -0.7 -0.1 -0.9 0 c -0.2 0.1 -0.3 0.2 -0.4 0.2 c 0.2 -0.3 0.5 -0.4 0.7 -0.4 c 0.5 0 1.3 -0.1 1.7 -0.1 c 0.6 0.1 0.7 0 0.7 0 c 0 0 0.4 -0.1 0.5 -0.1 c 0.5 0 1.2 0.3 1.7 0.2 c 0.3 0 0.5 0 0.7 -0.1 c -0.2 -0.1 -0.3 -0.1 -0.3 -0.2 c 0.1 0 0.5 0.1 0.6 0.1 c 0.8 0 1.1 0 1.4 -0.1 c 2.1 -0.2 2.2 -0.2 2.3 -0.3 c 0.5 -0.3 2.6 -0.7 3.6 -0.8 c 1.1 0 2.7 0.5 3.2 0.5 c 0.5 0 1.9 0.6 3.1 0.4 z z" fill="tan"/>
            <path id="jockey" d="M 10 0 c -1.1 -0.4 -1.5 -0.5 -2.3 -1 c -0.9 -0.5 -1.4 -1.3 -1.4 -1.7 c 0 -0.4 0.3 -1 1.3 -1.4 c 3 -1 3.8 -1 4.2 -1 c 2.1 -0.1 1.7 0.1 2.1 -1 c 0.5 -0.6 1.2 -0.7 1.6 -0.5 c 0.5 0.2 1.1 0.8 0.9 1.2 c 0 0.1 -0.1 0.2 -0.1 0.2 c 0 0.1 0.1 0.1 0.1 0.2 c 0.1 0 0.3 0.2 0.1 0.2 c -0.1 0 -0.3 0 -0.4 -0.1 c -0.1 0.1 -0.3 0.3 -0.3 0.5 c -0.1 0.4 -0.4 0.5 -0.5 0.7 c -0.3 0.2 -0.5 0.1 -0.8 -0.1 c -0.3 -0.2 -0.5 -0.1 -0.5 0.5 c 0 0.5 -0.4 0.6 -0.5 1 c -0.1 0.4 -0.2 0.8 0.3 1 c 0.5 0.2 1.7 0.6 1.8 0.3 c 0.1 -0.3 0.9 -0.2 0.8 0.2 c -0.1 0.4 -0.4 0.7 -0.8 0.4 c -0.3 -0.1 -0.8 0.3 -2.3 0.1 c -0.4 -0.1 -0.5 -0.1 -0.7 -0.5 c -0.2 -0.4 -0.1 -0.8 -0.7 -0.8 c -0.2 0 -1.1 0.1 -1.4 0.1 c 0.3 0.4 1.1 0.8 1.2 1.2 c 0.1 0.2 0 0.4 -0.1 0.5 c -0.4 0.4 -1.6 1.5 -1.8 1.8 c 0.4 0.1 0.9 0.1 0.9 0.2 c 0.1 0.2 0.1 0.3 0 0.4 c -0.4 0.4 -2.1 0.1 -2 -0.3 c 0.1 -0.4 0.6 -1.2 1.3 -2.3 z"/>
        </defs>
        <!-- ground (can use the mud filter if you want)-->
        <rect class="ground" x="-10" y="-10" width="100%" height="2000" fill="rgb(102,74,52)" />
        <g class="medals" transform="translate(100 0)">
            <!-- 1st -->
            <g class="goldMedal" transform="scale(0.2 0.2) translate(0 -200)">
                <clipPath id="medalMask">
                    <circle cx="50" cy="50" r="35" />
                </clipPath>
                <circle clip-path="url(#medalMask)" cx="50" cy="50" r="35" fill="gold" filter="brightness(90%)" />
                <path clip-path="url(#medalMask)" d="M -10 90 L 0 100 L 100 0 L 90 -10" fill="#fff">
                    <animate id="shine" attributeName="d" values="M -10 90 L 0 100 L 100 0 L 90 -10; M 50 150 L 60 160 L 160 60 L 150 50" dur="1s" begin="0s;shine.end+5s" fill="freeze" />
                </path>
                <path clip-path="url(#medalMask)" d="M 0 0 V 100 L 100 0 Z" fill="gold" filter="brightness(120%)" />
                <circle cx="50" cy="50" r="30" fill="gold" />
                <text x="50" y="50" dominant-baseline="middle" text-anchor="middle" fill="gold" filter="brightness(80%)" font-family="Arial, Helvetica, sans-serif" font-size="25">1st</text>
                <!-- 	shine -->
                <path clip-path="url(#medalMask)" d="M 40 140 L 50 150 L 150 50 L 140 40" fill="#fff">
                    <animate attributeName="d" values="M 40 140 L 50 150 L 150 50 L 140 40; M -60 40 L -50 50 L 50 -50 L 40 -60" dur="1s" begin="0.5s;shine.end+5.5s" fill="freeze" />
                </path>
                <text x="50" y="50" dominant-baseline="middle" text-anchor="middle" fill="rgba(255, 230, 15,0.1)" font-family="Arial, Helvetica, sans-serif" font-size="25">1st</text>
            </g>
            <!-- 2nd -->
            <g class="silverMedal" transform="scale(0.2 0.2) translate(1700 -200)">
                <circle clip-path="url(#medalMask)" cx="50" cy="50" r="35" fill="silver" filter="brightness(90%)" />
                <path clip-path="url(#medalMask)" d="M -10 90 L 0 100 L 100 0 L 90 -10" fill="#fff">
                    <animate id="shine" attributeName="d" values="M -10 90 L 0 100 L 100 0 L 90 -10; M 50 150 L 60 160 L 160 60 L 150 50" dur="1s" begin="0s;shine.end+5s" fill="freeze" />
                </path>
                <path clip-path="url(#medalMask)" d="M 0 0 V 100 L 100 0 Z" fill="silver" filter="brightness(120%)" />
                <circle cx="50" cy="50" r="30" fill="silver" />
                <text x="50" y="50" dominant-baseline="middle" text-anchor="middle" fill="silver" filter="brightness(80%)" font-family="Arial, Helvetica, sans-serif" font-size="25">2nd</text>
                <!-- 	shine -->
                <path clip-path="url(#medalMask)" d="M 40 140 L 50 150 L 150 50 L 140 40" fill="#fff">
                    <animate attributeName="d" values="M 40 140 L 50 150 L 150 50 L 140 40; M -60 40 L -50 50 L 50 -50 L 40 -60" dur="1s" begin="0.5s;shine.end+5.5s" fill="freeze" />
                </path>
                <text x="50" y="50" dominant-baseline="middle" text-anchor="middle" fill="#000" opacity="0.1" font-family="Arial, Helvetica, sans-serif" font-size="25">2nd</text>
            </g>
            <!-- 3rd -->
            <g class="bronzeMedal" transform="scale(0.2 0.2) translate(1700 -200)">
                <circle clip-path="url(#medalMask)" cx="50" cy="50" r="35" fill="rgb(185, 107, 30)" filter="brightness(90%)" />
                <path clip-path="url(#medalMask)" d="M -10 90 L 0 100 L 100 0 L 90 -10" fill="#fff">
                    <animate id="shine" attributeName="d" values="M -10 90 L 0 100 L 100 0 L 90 -10; M 50 150 L 60 160 L 160 60 L 150 50" dur="1s" begin="0s;shine.end+5s" fill="freeze" />
                </path>
                <path clip-path="url(#medalMask)" d="M 0 0 V 100 L 100 0 Z" fill="rgb(185, 107, 30)" filter="brightness(120%)" />
                <circle cx="50" cy="50" r="30" fill="rgb(185, 107, 30)" />
                <text x="50" y="50" dominant-baseline="middle" text-anchor="middle" fill="rgb(185, 107, 30)" filter="brightness(80%)" font-family="Arial, Helvetica, sans-serif" font-size="25">3rd</text>
                <!-- 	shine -->
                <path clip-path="url(#medalMask)" d="M 40 140 L 50 150 L 150 50 L 140 40" fill="#fff">
                    <animate attributeName="d" values="M 40 140 L 50 150 L 150 50 L 140 40; M -60 40 L -50 50 L 50 -50 L 40 -60" dur="1s" begin="0.5s;shine.end+5.5s" fill="freeze" />
                </path>
                <text x="50" y="50" dominant-baseline="middle" text-anchor="middle" fill="#000" opacity="0.1" font-family="Arial, Helvetica, sans-serif" font-size="25">3rd</text>
            </g>
        </g>
        <g class="finishLine">
            <path d="M420 -10v140" stroke="rgb(72,44,22)" stroke-width="12" />
            <path d="M420 0v120" stroke="#000" stroke-dasharray="5" stroke-width="10" />
            <path d="M420 0v120" stroke="#fff" stroke-dasharray="5" stroke-dashoffset="5" stroke-width="10" />
        </g>
        <g id="playerArea">
        <!-- riders populate here -->
        </g>
        <g class="startingBlocks">
            <!-- building -->
            <g class="startBuilding">
                <path d="M -10 -2 h 50 v 124 h-50" fill="url(#grad)" stroke="#000" stroke-width="0.5"/>
                <path d="M -10 -2 l 25 22 v 80 l-25 22 M 40 -2 l-25 22v 80 l25 22" fill="none" stroke="rgba(0,0,0,0.3)" stroke-width="0.5" />
            </g>
            <!-- gates -->
            <g id="gates">
            <!-- opening gates populate here -->
            </g>
        </g>
    </svg>
    
    <button class="restart" onclick="go()" title="Start the Race!">🏁</button>
</body>
</html>